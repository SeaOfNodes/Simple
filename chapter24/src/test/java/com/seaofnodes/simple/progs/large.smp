
struct stbi_io_callbacks {
    { i64 u8[] int -> int } read = "C";    // fill 'data' with 'size' bytes.  return number of bytes actually read
    { i64 int -> int } skip = "C"; // skip the next 'n' bytes, or 'unget' the last -n bytes if negative
    { i64 -> int } eof = "C";  // returns nonzero if we are at end of file/data
};

struct stbi__context {
    u32 img_x, img_y;
    int img_n, img_out_n;

    stbi_io_callbacks io;
    u8[]io_user_data;

    int read_from_callbacks;
    int buflen;
    u8[] buffer_start;
    int callback_already_read;

    u8[] img_buffer;
    int img_buffer_end;
    u8[] img_buffer_original;
    int img_buffer_original_end;
};

{ stbi__context -> u8 } stbi__get8 = "C";

val sample = { stbi__context s, int pal_len ->
    var palette = new u8[1024];
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }
    for (int i=0; i < pal_len; ++i) {
        palette[i*4+3] = 0;

        palette[i*4+0] = stbi__get8(s);
        palette[i*4+1] = stbi__get8(s);
        palette[i*4+2] = stbi__get8(s);
        palette[i*4+3] = 255;
        for (int j=0; j < pal_len; ++j) {
            palette[j*4+3] = 0;

            palette[j*4+0] = stbi__get8(s);
            palette[j*4+1] = stbi__get8(s);
            palette[j*4+2] = stbi__get8(s);
            palette[j*4+3] = 255;
        }
    }

    return palette;
};
